"use strict";(self.webpackChunkrke_docs=self.webpackChunkrke_docs||[]).push([[2028],{9327:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>r,contentTitle:()=>a,default:()=>u,frontMatter:()=>t,metadata:()=>s,toc:()=>c});var o=l(5893),i=l(1151);const t={title:"Network Plug-ins"},a=void 0,s={id:"config-options/add-ons/network-plugins/network-plugins",title:"Network Plug-ins",description:"RKE provides the following network plug-ins that are deployed as add-ons:",source:"@site/docs/config-options/add-ons/network-plugins/network-plugins.md",sourceDirName:"config-options/add-ons/network-plugins",slug:"/config-options/add-ons/network-plugins/",permalink:"/config-options/add-ons/network-plugins/",draft:!1,unlisted:!1,editUrl:"https://github.com/rancher/rke1-docs/edit/main/docs/config-options/add-ons/network-plugins/network-plugins.md",tags:[],version:"current",lastUpdatedAt:1700871198,formattedLastUpdatedAt:"Nov 25, 2023",frontMatter:{title:"Network Plug-ins"},sidebar:"mySidebar",previous:{title:"Add-Ons",permalink:"/config-options/add-ons/"},next:{title:"Custom Network Plug-in Example",permalink:"/config-options/add-ons/network-plugins/custom-network-plugin-example/"}},r={},c=[{value:"Changing the Default Network Plug-in",id:"changing-the-default-network-plug-in",level:2},{value:"Disabling Deployment of a Network Plug-in",id:"disabling-deployment-of-a-network-plug-in",level:2},{value:"Network Plug-in Options",id:"network-plug-in-options",level:2},{value:"Canal",id:"canal",level:2},{value:"Canal Network Plug-in Options",id:"canal-network-plug-in-options",level:3},{value:"Canal Interface",id:"canal-interface",level:3},{value:"Canal Network Plug-in Tolerations",id:"canal-network-plug-in-tolerations",level:3},{value:"Flannel",id:"flannel",level:2},{value:"Flannel Network Plug-in Options",id:"flannel-network-plug-in-options",level:3},{value:"Flannel Interface",id:"flannel-interface",level:3},{value:"Calico",id:"calico",level:2},{value:"Calico Network Plug-in Options",id:"calico-network-plug-in-options",level:3},{value:"Calico Cloud Provider",id:"calico-cloud-provider",level:3},{value:"Calico Network Plug-in Tolerations",id:"calico-network-plug-in-tolerations",level:3},{value:"Weave",id:"weave",level:2},{value:"Weave Network Plug-in Options",id:"weave-network-plug-in-options",level:3},{value:"Weave Encryption",id:"weave-encryption",level:3},{value:"Custom Network Plug-ins",id:"custom-network-plug-ins",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:"RKE provides the following network plug-ins that are deployed as add-ons:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Flannel"}),"\n",(0,o.jsx)(n.li,{children:"Calico"}),"\n",(0,o.jsx)(n.li,{children:"Canal"}),"\n",(0,o.jsx)(n.li,{children:"Weave"}),"\n"]}),"\n",(0,o.jsx)(n.admonition,{type:"warning",children:(0,o.jsx)(n.p,{children:"After you launch the cluster, you cannot change your network provider. Therefore, choose which network provider you want to use carefully, as Kubernetes doesn\u2019t allow switching between network providers. Once a cluster is created with a network provider, changing network providers would require you tear down the entire cluster and all its applications."})}),"\n",(0,o.jsx)(n.h2,{id:"changing-the-default-network-plug-in",children:"Changing the Default Network Plug-in"}),"\n",(0,o.jsxs)(n.p,{children:["By default, the network plug-in is ",(0,o.jsx)(n.code,{children:"canal"}),". If you want to use another network plug-in, you need to specify which network plug-in to enable at the cluster level in the ",(0,o.jsx)(n.code,{children:"cluster.yml"}),"."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"## Setting the flannel network plug-in\nnetwork:\n  plugin: flannel\n"})}),"\n",(0,o.jsxs)(n.p,{children:["The images used for network plug-ins are under the ",(0,o.jsxs)(n.a,{href:"/config-options/system-images/",children:[(0,o.jsx)(n.code,{children:"system_images"})," directive"]}),". For each Kubernetes version, there are default images associated with each network plug-in, but these can be overridden by changing the image tag in ",(0,o.jsx)(n.code,{children:"system_images"}),"."]}),"\n",(0,o.jsx)(n.h2,{id:"disabling-deployment-of-a-network-plug-in",children:"Disabling Deployment of a Network Plug-in"}),"\n",(0,o.jsxs)(n.p,{children:["You can disable deploying a network plug-in by specifying ",(0,o.jsx)(n.code,{children:"none"})," to the network ",(0,o.jsx)(n.code,{children:"plugin"})," directive in the cluster configuration."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"network:\n  plugin: none\n"})}),"\n",(0,o.jsx)(n.h2,{id:"network-plug-in-options",children:"Network Plug-in Options"}),"\n",(0,o.jsx)(n.p,{children:"Besides the different images that could be used to deploy network plug-ins, certain network plug-ins support additional options that can be used to customize the network plug-in."}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"#canal",children:"Canal"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"#flannel",children:"Flannel"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"#calico",children:"Calico"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"#weave",children:"Weave"})}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"canal",children:"Canal"}),"\n",(0,o.jsx)(n.h3,{id:"canal-network-plug-in-options",children:"Canal Network Plug-in Options"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"network:\n  plugin: canal\n  options:\n    canal_iface: eth1\n    canal_flannel_backend_type: vxlan\n    canal_autoscaler_priority_class_name: system-cluster-critical # Available as of RKE v1.2.6+\n    canal_priority_class_name: system-cluster-critical # Available as of RKE v1.2.6+\n"})}),"\n",(0,o.jsx)(n.h3,{id:"canal-interface",children:"Canal Interface"}),"\n",(0,o.jsxs)(n.p,{children:["By setting the ",(0,o.jsx)(n.code,{children:"canal_iface"}),", you can configure the interface to use for inter-host communication."]}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"canal_flannel_backend_type"})," option allows you to specify the type of ",(0,o.jsx)(n.a,{href:"https://github.com/coreos/flannel/blob/master/Documentation/backends.md",children:"flannel backend"})," to use. By default the ",(0,o.jsx)(n.code,{children:"vxlan"})," backend is used."]}),"\n",(0,o.jsx)(n.h3,{id:"canal-network-plug-in-tolerations",children:"Canal Network Plug-in Tolerations"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.em,{children:"Available as of v1.2.4"})}),"\n",(0,o.jsxs)(n.p,{children:["The configured tolerations apply to the ",(0,o.jsx)(n.code,{children:"calico-kube-controllers"})," Deployment."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'network:\n  plugin: canal\n  tolerations:\n  - key: "node.kubernetes.io/unreachable"\n    operator: "Exists"\n    effect: "NoExecute"\n    tolerationseconds: 300\n  - key: "node.kubernetes.io/not-ready"\n    operator: "Exists"\n    effect: "NoExecute"\n    tolerationseconds: 300\n'})}),"\n",(0,o.jsxs)(n.p,{children:["To check for applied tolerations on the ",(0,o.jsx)(n.code,{children:"calico-kube-controllers"})," Deployment, use the following command:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"kubectl -n kube-system get deploy calico-kube-controllers -o jsonpath='{.spec.template.spec.tolerations}'\n"})}),"\n",(0,o.jsx)(n.h2,{id:"flannel",children:"Flannel"}),"\n",(0,o.jsx)(n.h3,{id:"flannel-network-plug-in-options",children:"Flannel Network Plug-in Options"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"network:\n  plugin: flannel\n  options:\n    flannel_iface: eth1\n    flannel_backend_type: vxlan\n    flannel_autoscaler_priority_class_name: system-cluster-critical # Available as of RKE v1.2.6+\n    flannel_priority_class_name: system-cluster-critical # Available as of RKE v1.2.6+\n"})}),"\n",(0,o.jsx)(n.h3,{id:"flannel-interface",children:"Flannel Interface"}),"\n",(0,o.jsxs)(n.p,{children:["By setting the ",(0,o.jsx)(n.code,{children:"flannel_iface"}),", you can configure the interface to use for inter-host communication.\nThe ",(0,o.jsx)(n.code,{children:"flannel_backend_type"})," option allows you to specify the type of ",(0,o.jsx)(n.a,{href:"https://github.com/coreos/flannel/blob/master/Documentation/backends.md",children:"flannel backend"})," to use. By default the ",(0,o.jsx)(n.code,{children:"vxlan"})," backend is used."]}),"\n",(0,o.jsx)(n.h2,{id:"calico",children:"Calico"}),"\n",(0,o.jsx)(n.h3,{id:"calico-network-plug-in-options",children:"Calico Network Plug-in Options"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"network:\n  plugin: calico\n  options:\n    calico_cloud_provider: aws\n    calico_autoscaler_priority_class_name: system-cluster-critical # Available as of RKE v1.2.6+\n    calico_priority_class_name: system-cluster-critical # Available as of RKE v1.2.6+\n"})}),"\n",(0,o.jsx)(n.h3,{id:"calico-cloud-provider",children:"Calico Cloud Provider"}),"\n",(0,o.jsxs)(n.p,{children:["Calico currently only supports 2 cloud providers, AWS or GCE, which can be set using ",(0,o.jsx)(n.code,{children:"calico_cloud_provider"}),"."]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Valid Options"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"aws"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"gce"})}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"calico-network-plug-in-tolerations",children:"Calico Network Plug-in Tolerations"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.em,{children:"Available as of v1.2.4"})}),"\n",(0,o.jsxs)(n.p,{children:["The configured tolerations apply to the ",(0,o.jsx)(n.code,{children:"calico-kube-controllers"})," Deployment."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'network:\n  plugin: calico\n  tolerations:\n  - key: "node.kubernetes.io/unreachable"\n    operator: "Exists"\n    effect: "NoExecute"\n    tolerationseconds: 300\n  - key: "node.kubernetes.io/not-ready"\n    operator: "Exists"\n    effect: "NoExecute"\n    tolerationseconds: 300\n'})}),"\n",(0,o.jsxs)(n.p,{children:["To check for applied tolerations on the ",(0,o.jsx)(n.code,{children:"calico-kube-controllers"})," Deployment, use the following command:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"kubectl -n kube-system get deploy calico-kube-controllers -o jsonpath='{.spec.template.spec.tolerations}'\n"})}),"\n",(0,o.jsx)(n.h2,{id:"weave",children:"Weave"}),"\n",(0,o.jsx)(n.admonition,{type:"warning",children:(0,o.jsx)(n.p,{children:"Weave is deprecated in v1.27 and will be removed in v1.30"})}),"\n",(0,o.jsx)(n.h3,{id:"weave-network-plug-in-options",children:"Weave Network Plug-in Options"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'network:\n  plugin: weave\n  options:\n    weave_autoscaler_priority_class_name: system-cluster-critical # Available as of RKE v1.2.6+\n    weave_priority_class_name: system-cluster-critical # Available as of RKE v1.2.6+\n  weave_network_provider:\n    password: "Q]SZOQ5wp@n$oijz"\n'})}),"\n",(0,o.jsx)(n.h3,{id:"weave-encryption",children:"Weave Encryption"}),"\n",(0,o.jsx)(n.p,{children:"Weave encryption can be enabled by passing a string password to the network provider config."}),"\n",(0,o.jsx)(n.h2,{id:"custom-network-plug-ins",children:"Custom Network Plug-ins"}),"\n",(0,o.jsxs)(n.p,{children:["It is possible to add a custom network plug-in by using the ",(0,o.jsx)(n.a,{href:"/config-options/add-ons/user-defined-add-ons/",children:"user-defined add-on functionality"})," of RKE. In the ",(0,o.jsx)(n.code,{children:"addons"})," field, you can add the add-on manifest of a cluster that has the network plugin-that you want, as shown in ",(0,o.jsx)(n.a,{href:"/config-options/add-ons/network-plugins/custom-network-plugin-example/",children:"this example."})]})]})}function u(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},1151:(e,n,l)=>{l.d(n,{Z:()=>s,a:()=>a});var o=l(7294);const i={},t=o.createContext(i);function a(e){const n=o.useContext(t);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),o.createElement(t.Provider,{value:n},e.children)}}}]);