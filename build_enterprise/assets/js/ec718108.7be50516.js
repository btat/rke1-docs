"use strict";(self.webpackChunkrke_docs=self.webpackChunkrke_docs||[]).push([[7558],{6710:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>t,default:()=>u,frontMatter:()=>i,metadata:()=>r,toc:()=>l});var d=s(5893),o=s(1151);const i={title:"User-Defined Add-Ons"},t=void 0,r={id:"config-options/add-ons/user-defined-add-ons/user-defined-add-ons",title:"User-Defined Add-Ons",description:"Besides the network plug-in and ingress controllers, you can define any add-on that you want deployed after the Kubernetes cluster is deployed.",source:"@site/docs/config-options/add-ons/user-defined-add-ons/user-defined-add-ons.md",sourceDirName:"config-options/add-ons/user-defined-add-ons",slug:"/config-options/add-ons/user-defined-add-ons/",permalink:"/config-options/add-ons/user-defined-add-ons/",draft:!1,unlisted:!1,editUrl:"https://github.com/rancher/rke1-docs/edit/main/docs/config-options/add-ons/user-defined-add-ons/user-defined-add-ons.md",tags:[],version:"current",lastUpdatedAt:1683135121,formattedLastUpdatedAt:"May 3, 2023",frontMatter:{title:"User-Defined Add-Ons"},sidebar:"mySidebar",previous:{title:"Metrics Server",permalink:"/config-options/add-ons/metrics-server/"},next:{title:"Example Cluster.ymls",permalink:"/example-yamls/"}},a={},l=[{value:"In-line Add-ons",id:"in-line-add-ons",level:2},{value:"Referencing YAML files for Add-ons",id:"referencing-yaml-files-for-add-ons",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.a)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(n.p,{children:["Besides the ",(0,d.jsx)(n.a,{href:"/config-options/add-ons/network-plugins/",children:"network plug-in"})," and ",(0,d.jsx)(n.a,{href:"/config-options/add-ons/ingress-controllers/",children:"ingress controllers"}),", you can define any add-on that you want deployed after the Kubernetes cluster is deployed."]}),"\n",(0,d.jsx)(n.p,{children:"There are two ways that you can specify an add-on."}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.a,{href:"#in-line-add-ons",children:"In-line Add-ons"})}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.a,{href:"#referencing-yaml-files-for-add-ons",children:"Referencing YAML Files for Add-ons"})}),"\n"]}),"\n",(0,d.jsx)(n.admonition,{type:"note",children:(0,d.jsxs)(n.p,{children:["When using user-defined add-ons, you ",(0,d.jsx)(n.em,{children:"must"})," define a namespace for ",(0,d.jsx)(n.em,{children:"all"})," your resources, otherwise they will end up in the ",(0,d.jsx)(n.code,{children:"kube-system"})," namespace."]})}),"\n",(0,d.jsxs)(n.p,{children:["RKE uploads the YAML manifest as a configmap to the Kubernetes cluster. Then, it runs a Kubernetes job that mounts the configmap and deploys the add-on using ",(0,d.jsx)(n.code,{children:"kubectl apply -f"}),"."]}),"\n",(0,d.jsxs)(n.p,{children:["RKE only adds additional add-ons when using ",(0,d.jsx)(n.code,{children:"rke up"})," multiple times. RKE does ",(0,d.jsx)(n.strong,{children:"not"})," support removing of cluster add-ons when doing ",(0,d.jsx)(n.code,{children:"rke up"})," with a different list of add-ons."]}),"\n",(0,d.jsx)(n.p,{children:"As of v0.1.8, RKE will update an add-on if it is the same name."}),"\n",(0,d.jsxs)(n.p,{children:["Before v0.1.8, update any add-ons by using ",(0,d.jsx)(n.code,{children:"kubectl edit"}),"."]}),"\n",(0,d.jsx)(n.h2,{id:"in-line-add-ons",children:"In-line Add-ons"}),"\n",(0,d.jsxs)(n.p,{children:["To define an add-on directly in the YAML file, make sure to use the YAML's block indicator ",(0,d.jsx)(n.code,{children:"|-"})," as the ",(0,d.jsx)(n.code,{children:"addons"})," directive is a multi-line string option. It's possible to specify multiple YAML resource definitions by separating them using the ",(0,d.jsx)(n.code,{children:"---"})," directive."]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",children:"addons: |-\n    ---\n    apiVersion: v1\n    kind: Pod\n    metadata:\n      name: my-nginx\n      namespace: default\n    spec:\n      containers:\n      - name: my-nginx\n        image: nginx\n        ports:\n        - containerPort: 80\n"})}),"\n",(0,d.jsx)(n.h2,{id:"referencing-yaml-files-for-add-ons",children:"Referencing YAML files for Add-ons"}),"\n",(0,d.jsxs)(n.p,{children:["Use the ",(0,d.jsx)(n.code,{children:"addons_include"})," directive to reference a local file or a URL for any user-defined add-ons."]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",children:"addons_include:\n    - https://raw.githubusercontent.com/rook/rook/master/cluster/examples/kubernetes/ceph/operator.yaml\n    - https://raw.githubusercontent.com/rook/rook/master/cluster/examples/kubernetes/ceph/cluster.yaml\n    - /opt/manifests/example.yaml\n    - ./nginx.yaml\n"})})]})}function u(e={}){const{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(c,{...e})}):c(e)}},1151:(e,n,s)=>{s.d(n,{Z:()=>r,a:()=>t});var d=s(7294);const o={},i=d.createContext(o);function t(e){const n=d.useContext(i);return d.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:t(e.components),d.createElement(i.Provider,{value:n},e.children)}}}]);