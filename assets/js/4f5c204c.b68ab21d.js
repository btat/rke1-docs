"use strict";(self.webpackChunkrke_docs=self.webpackChunkrke_docs||[]).push([[1963],{6964:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>h,contentTitle:()=>s,default:()=>l,frontMatter:()=>t,metadata:()=>c,toc:()=>d});var o=n(5893),i=n(1151);const t={title:"vSphere Cloud Provider"},s=void 0,c={id:"config-options/cloud-providers/vsphere/vsphere",title:"vSphere Cloud Provider",description:"This section describes how to enable the vSphere cloud provider. You will need to use the cloud_provider directive in the cluster YAML file. For more details on configuring the file structure refer to the configuration reference.",source:"@site/docs/config-options/cloud-providers/vsphere/vsphere.md",sourceDirName:"config-options/cloud-providers/vsphere",slug:"/config-options/cloud-providers/vsphere/",permalink:"/config-options/cloud-providers/vsphere/",draft:!1,unlisted:!1,editUrl:"https://github.com/rancher/rke1-docs/edit/main/docs/config-options/cloud-providers/vsphere/vsphere.md",tags:[],version:"current",lastUpdatedAt:1704844723,formattedLastUpdatedAt:"Jan 9, 2024",frontMatter:{title:"vSphere Cloud Provider"},sidebar:"mySidebar",previous:{title:"OpenStack Cloud Provider",permalink:"/config-options/cloud-providers/openstack/"},next:{title:"Enabling Disk UUIDs for vSphere VMs",permalink:"/config-options/cloud-providers/vsphere/enabling-uuid/"}},h={},d=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Enabling the vSphere Provider with the RKE CLI",id:"enabling-the-vsphere-provider-with-the-rke-cli",level:2},{value:"Enabling the vSphere Provider in Rancher",id:"enabling-the-vsphere-provider-in-rancher",level:2},{value:"Related Links",id:"related-links",level:2}];function a(e){const r={a:"a",code:"code",h2:"h2",li:"li",p:"p",strong:"strong",ul:"ul",...(0,i.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(r.p,{children:["This section describes how to enable the vSphere cloud provider. You will need to use the ",(0,o.jsx)(r.code,{children:"cloud_provider"})," directive in the cluster YAML file. For more details on configuring the file structure refer to the ",(0,o.jsx)(r.a,{href:"/config-options/cloud-providers/vsphere/config-reference/",children:"configuration reference"}),"."]}),"\n",(0,o.jsxs)(r.p,{children:["The ",(0,o.jsx)(r.a,{href:"https://vmware.github.io/vsphere-storage-for-kubernetes/documentation/",children:"vSphere Cloud Provider"})," interacts with VMware infrastructure (vCenter or standalone ESXi server) to provision and manage storage for persistent volumes in a Kubernetes cluster."]}),"\n",(0,o.jsx)(r.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.strong,{children:"Credentials:"})," You'll need to have credentials of a vCenter/ESXi user account with privileges allowing the cloud provider to interact with the vSphere infrastructure to provision storage.\xa0Refer to ",(0,o.jsx)(r.a,{href:"https://vmware.github.io/vsphere-storage-for-kubernetes/documentation/vcp-roles.html",children:"this document"})," to create and assign a role with the required permissions in vCenter."]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.strong,{children:"VMware Tools"})," must be running in the Guest OS for all nodes in the cluster."]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.strong,{children:"Disk UUIDs:"})," All nodes must be configured with disk UUIDs. This is required so that attached VMDKs present a consistent UUID to the VM, allowing the disk to be mounted properly. See the section on ",(0,o.jsx)(r.a,{href:"/config-options/cloud-providers/vsphere/enabling-uuid/",children:"enabling disk UUIDs."})]}),"\n"]}),"\n",(0,o.jsx)(r.h2,{id:"enabling-the-vsphere-provider-with-the-rke-cli",children:"Enabling the vSphere Provider with the RKE CLI"}),"\n",(0,o.jsxs)(r.p,{children:["To enable the vSphere Cloud Provider in the cluster, you must add the top-level ",(0,o.jsx)(r.code,{children:"cloud_provider"})," directive to the cluster configuration file, set the ",(0,o.jsx)(r.code,{children:"name"})," property to ",(0,o.jsx)(r.code,{children:"vsphere"})," and add the ",(0,o.jsx)(r.code,{children:"vsphereCloudProvider"})," directive containing the configuration matching your infrastructure. See the ",(0,o.jsx)(r.a,{href:"/config-options/cloud-providers/vsphere/config-reference/",children:"configuration reference"})," for more details."]}),"\n",(0,o.jsx)(r.h2,{id:"enabling-the-vsphere-provider-in-rancher",children:"Enabling the vSphere Provider in Rancher"}),"\n",(0,o.jsxs)(r.p,{children:["When provisioning Kubernetes using ",(0,o.jsx)(r.a,{href:"https://ranchermanager.docs.rancher.com/pages-for-subheaders/launch-kubernetes-with-rancher",children:"RKE clusters"})," in Rancher, the vSphere Cloud Provider can be enabled by configuring the ",(0,o.jsx)(r.code,{children:"cloud_provider"})," directive nested under the ",(0,o.jsx)(r.code,{children:"rancher_kubernetes_engine_config"})," directive in the cluster config YAML file. For more information on the configuration file structure please see the ",(0,o.jsx)(r.a,{href:"https://ranchermanager.docs.rancher.com/reference-guides/cluster-configuration/rancher-server-configuration/rke1-cluster-configuration#config-file-structure-in-rancher",children:"Rancher RKE Cluster Configuration Reference"}),"."]}),"\n",(0,o.jsx)(r.h2,{id:"related-links",children:"Related Links"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.strong,{children:"Configuration:"})," For details on vSphere configuration in RKE, refer to the ",(0,o.jsx)(r.a,{href:"/config-options/cloud-providers/vsphere/config-reference/",children:"configuration reference."})]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.strong,{children:"Troubleshooting:"})," For guidance on troubleshooting a cluster with the vSphere cloud provider enabled, refer to the ",(0,o.jsx)(r.a,{href:"/config-options/cloud-providers/vsphere/troubleshooting/",children:"troubleshooting section."})]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.strong,{children:"Storage:"})," If you are setting up storage, see the ",(0,o.jsx)(r.a,{href:"https://vmware.github.io/vsphere-storage-for-kubernetes/documentation/",children:"official vSphere documentation on storage for Kubernetes,"})," or the ",(0,o.jsx)(r.a,{href:"https://kubernetes.io/docs/concepts/storage/persistent-volumes/",children:"official Kubernetes documentation on persistent volumes."})," If you are using Rancher, refer to the ",(0,o.jsx)(r.a,{href:"https://ranchermanager.docs.rancher.com/how-to-guides/new-user-guides/manage-clusters/provisioning-storage-examples/vsphere-storage#docusaurus_skipToContent_fallback",children:"Rancher documentation on provisioning storage in vSphere."})]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.strong,{children:"For Rancher users:"})," Refer to the Rancher documentation on ",(0,o.jsx)(r.a,{href:"https://ranchermanager.docs.rancher.com/pages-for-subheaders/vsphere",children:"creating vSphere Kubernetes clusters"})," and ",(0,o.jsx)(r.a,{href:"https://ranchermanager.docs.rancher.com/how-to-guides/new-user-guides/manage-clusters/provisioning-storage-examples/vsphere-storage#docusaurus_skipToContent_fallback",children:"provisioning storage."})]}),"\n"]})]})}function l(e={}){const{wrapper:r}={...(0,i.a)(),...e.components};return r?(0,o.jsx)(r,{...e,children:(0,o.jsx)(a,{...e})}):a(e)}},1151:(e,r,n)=>{n.d(r,{Z:()=>c,a:()=>s});var o=n(7294);const i={},t=o.createContext(i);function s(e){const r=o.useContext(t);return o.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),o.createElement(t.Provider,{value:r},e.children)}}}]);