"use strict";(self.webpackChunkrke_docs=self.webpackChunkrke_docs||[]).push([[88],{6045:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>r,metadata:()=>a,toc:()=>d});var s=n(5893),o=n(1151);const r={title:"Dual-stack"},i=void 0,a={id:"config-options/dual-stack/dual-stack",title:"Dual-stack",description:"As of RKE v1.3.0, dual-stack networking support has been added, which allows allocating both IPv4 and IPv6 addresses to pods and services.",source:"@site/docs/config-options/dual-stack/dual-stack.md",sourceDirName:"config-options/dual-stack",slug:"/config-options/dual-stack/",permalink:"/config-options/dual-stack/",draft:!1,unlisted:!1,editUrl:"https://github.com/rancher/rke1-docs/edit/main/docs/config-options/dual-stack/dual-stack.md",tags:[],version:"current",lastUpdatedAt:1707343823,formattedLastUpdatedAt:"Feb 7, 2024",frontMatter:{title:"Dual-stack"},sidebar:"mySidebar",previous:{title:"Audit Log",permalink:"/config-options/audit-log/"},next:{title:"Add-Ons",permalink:"/config-options/add-ons/"}},c={},d=[{value:"Requirements",id:"requirements",level:3},{value:"Example RKE Configuration",id:"example-rke-configuration",level:3}];function l(e){const t={a:"a",code:"code",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(t.p,{children:["As of RKE ",(0,s.jsx)(t.code,{children:"v1.3.0"}),", ",(0,s.jsx)(t.a,{href:"https://kubernetes.io/docs/concepts/services-networking/dual-stack/",children:"dual-stack"})," networking support has been added, which allows allocating both IPv4 and IPv6 addresses to pods and services."]}),"\n",(0,s.jsx)(t.h3,{id:"requirements",children:"Requirements"}),"\n",(0,s.jsx)(t.p,{children:"In order to use the dual-stack feature, RKE and the infrastructure it's deploy to must be configured as follows:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Kubernetes 1.21 or newer is used."}),"\n",(0,s.jsx)(t.li,{children:"RKE is configured to use Calico as the Container Network Interface (CNI) provider. Other providers are not supported."}),"\n",(0,s.jsx)(t.li,{children:"RKE is deployed on Amazon EC2 instances with the following prerequisites:"}),"\n",(0,s.jsx)(t.li,{children:"Enable IPv6 support: set the network range at VPC and its subnetworks."}),"\n",(0,s.jsx)(t.li,{children:"Add a IPv6 default gateway to VPC routes."}),"\n",(0,s.jsx)(t.li,{children:"Add inbound/outbound rules for IPv6 traffic to your cluster's security group(s)."}),"\n",(0,s.jsxs)(t.li,{children:["Ensure instances have ",(0,s.jsx)(t.code,{children:"Auto-assign IPv6 IP"})," enabled. See the ",(0,s.jsx)(t.a,{href:"https://docs.aws.amazon.com/vpc/latest/userguide/vpc-ip-addressing.html",children:"AWS documentation"})," for instructions."]}),"\n",(0,s.jsxs)(t.li,{children:["Disable source/destination checks on all instances in the cluster. See the ",(0,s.jsx)(t.a,{href:"https://docs.aws.amazon.com/vpc/latest/userguide/VPC_NAT_Instance.html#EIP_Disable_SrcDestCheck",children:"AWS documentation"})," for instructions."]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["For more information on configuring your AWS enivronment for IPv6, refer to the AWS ",(0,s.jsx)(t.a,{href:"https://docs.aws.amazon.com/vpc/latest/userguide/get-started-IPv6.html",children:"Getting started with IPv6"})," documentation."]}),"\n",(0,s.jsx)(t.h3,{id:"example-rke-configuration",children:"Example RKE Configuration"}),"\n",(0,s.jsx)(t.p,{children:"The following is an example RKE configuration that can be used to deploy RKE with dual-stack support configured:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:'kubernetes_version: "v1.21.1-rancher2-1"\nservices:\n  kube-api:\n    service_cluster_ip_range: 10.43.0.0/16,fd98::/108\n  kube-controller:\n    service_cluster_ip_range: 10.43.0.0/16,fd98::/108\n    cluster_cidr: 10.42.0.0/16,fd01::/64\n\nnetwork:\n  plugin: calico\n'})})]})}function u(e={}){const{wrapper:t}={...(0,o.a)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},1151:(e,t,n)=>{n.d(t,{Z:()=>a,a:()=>i});var s=n(7294);const o={},r=s.createContext(o);function i(e){const t=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);